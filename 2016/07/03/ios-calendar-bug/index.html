<!DOCTYPE html><html lang=""><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> [iOS å¼€å‘] NSCalendar è¿™ä¸ªå‘è´§â€”â€”è·å–ç³»ç»Ÿå½“å‰æ—¶é—´å¹´ä»½å‡ºé”™ Â· Shannon's Blog</title><meta name="description" content="[iOS å¼€å‘] NSCalendar è¿™ä¸ªå‘è´§â€”â€”è·å–ç³»ç»Ÿå½“å‰æ—¶é—´å¹´ä»½å‡ºé”™ - ShannonChenCHN"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Shannon's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">TAG</a></li><li class="nav-list-item"><a href="https://github.com/ShannonChenCHN" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">[iOS å¼€å‘] NSCalendar è¿™ä¸ªå‘è´§â€”â€”è·å–ç³»ç»Ÿå½“å‰æ—¶é—´å¹´ä»½å‡ºé”™</h1><div class="post-info">Jul 3, 2016</div><div class="post-content"><blockquote>
<p>èƒŒæ™¯ï¼šæœ€è¿‘ BI çš„åŒå­¦åæ˜ ï¼Œæ ¹æ®æˆ‘ä»¬ iOS å®¢æˆ·ç«¯æ”¶é›†çš„åŸ‹ç‚¹æ•°æ®æ˜¾ç¤ºï¼Œ<strong>æœ‰ä¸€éƒ¨åˆ†æ•°æ®çš„åŸ‹ç‚¹æ—¶é—´</strong>ä¸å¯¹ï¼Œä½†æ˜¯æˆ‘åœ¨å·¥ç¨‹ä»£ç ä¸­æ–­ç‚¹è°ƒè¯•æ—¶å´æ²¡æœ‰å‘ç°ä»»ä½•å¼‚å¸¸æƒ…å†µã€‚</p>
</blockquote>
<p>BI åŒå­¦æä¾›çš„â€œè¯æ®â€å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå›¾ä¸­åœˆå‡ºæ¥çš„ tracktime ï¼ˆ<strong>0028</strong>0629104535ï¼‰æœ¬åº”æ˜¾ç¤ºçš„æ—¶é—´ç†åº”æ˜¯ <strong>2016</strong>0629104535ï¼Œæœºæ™ºçš„ BI åŒå­¦åˆ†æå…¶åŸå› å¯èƒ½æ˜¯ï¼Œæˆ‘ä»¬è®°å½•æ—¶é—´çš„ä»£ç åœ¨æŸäº›æœºå™¨ä¸Šå¯èƒ½æœ‰é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´æœºå‹é€‚é…é—®é¢˜ï¼Œä½†æ ¹æ®æˆ‘å¤šå¹´çš„å¼€å‘ç»éªŒæ¥çœ‹ï¼ˆä¸è¦ç¬‘ï¼‰ï¼Œé—®é¢˜åº”è¯¥ä¸åœ¨äºæ­¤ï¼Œå…¶ä¸­å¿…å®šå¦æœ‰è¹Šè··ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/814356-647545c57db8b16e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åŸ‹ç‚¹æ•°æ®.png"><br>äºæ˜¯ï¼Œæˆ‘çœ‹äº†ä¸€ä¸‹æˆ‘ä»¬è®°å½•åŸ‹ç‚¹æ—¶é—´çš„ç›¸å…³ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// tt</span><br><span class="line">NSDateFormatter *dateformatter=[[NSDateFormatter alloc] init];</span><br><span class="line">[dateformatter setDateFormat:@&quot;yyyyMMddHHmmss&quot;];</span><br><span class="line">[mutDict setString:[dateformatter stringFromDate:[NSDate date]] forKey:MTCLICK_KEY_TT];</span><br></pre></td></tr></table></figure></p>
<p>ç¬¬ä¸€çœ¼çœ‹ä¸Šå»è²Œä¼¼å¾ˆæ­£å¸¸ï¼Œæ‰“ä¸ªæ–­ç‚¹ï¼Œæ‰“å°å‡ºæ¥çš„æ—¶é—´ä¹Ÿæ²¡é—®é¢˜ã€‚é‚£ä¹ˆé—®é¢˜åœ¨å“ªå‘¢ï¼Ÿéš¾é“çœŸæ˜¯æœºå‹é—®é¢˜ï¼Ÿä½†ä»æ²¡å¬è¯´è¿‡æœºå‹è·Ÿè¿™æ—¶é—´æ ¼å¼æœ‰æ¯›å…³ç³»å•Šã€‚</p>
<p>é‚£å°±åªèƒ½å…ˆä» NSDateFormatter å…¥æ‰‹äº†ï¼Œé¦–å…ˆæ±‚åŠ©äºå®˜æ–¹æ–‡æ¡£ Data Formatting Guideï¼Œåœ¨ Date Formatters ç« èŠ‚ä¸­çš„ Use Format Strings to Specify Custom Formats å‘ç°å…¶ä¸­æœ‰è¿™æ ·ä¸€æ®µè¯ï¼š</p>
<blockquote>
<p> There are two things to note about this example:</p>
<ol>
<li>It uses yyyy to specify the year component. <strong>A common mistake is to use YYYY.</strong> yyyy specifies the calendar year whereas YYYY specifies the year (of â€œWeek of Yearâ€), used in the ISO year-week calendar. In most cases, yyyy and YYYY yield the same number, however they may be different. Typically you should use the calendar year.</li>
</ol>
<p>2.The representation of the time may be 13:00. In iOS, however, if the user has switched 24-Hour Time to Off, the time may be 1:00 pm.</p>
</blockquote>
<p>è¯»åˆ°æ­¤å¤„ï¼Œæˆ‘æ„Ÿæ…¨ä¸‡åˆ†ï¼Œåˆ°å¤„éƒ½æ˜¯å‘å•Šï¼é¡¿æ—¶æƒ³èµ·<strong>å¹´åˆ</strong>æ—¶çš„é‚£ä¸ªä¼˜æƒ åˆ¸æœ‰æ•ˆæœŸçš„ bugï¼Œå°±æ˜¯å› ä¸ºæ—¶é—´æ ¼å¼çš„å¹´ä»½ç”¨äº† â€œYYYYâ€ï¼Œè€Œä¸æ˜¯ â€œyyyyâ€ï¼Œè€Œå¯¼è‡´äº†ä¸€ä¸ªå¹³æ—¶çœ‹ä¸å‡ºæ¥åˆ°è·¨å¹´çš„æ—¶å€™æ‰å‡ºç°çš„é—®é¢˜ã€‚<figure class="highlight plain"><figcaption><span>specifies the calendar year whereas YYYY specifies the year (of â€œWeek of Yearâ€), used in the ISO year-week calendar. ```è¿™å¥è¯å¾ˆå…³é”®ï¼Œç”±æ­¤å¯ä»¥çœ‹å‡ºä¹‹å‰è¿™ä¸ªé—®é¢˜çš„æ ¹æœ¬å°±åœ¨äºæ—¥å†ï¼ˆcalendarï¼‰çš„åŒºåˆ«ã€‚</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ç°åœ¨æˆ‘ä»¬å†å›è¿‡å¤´æ¥çœ‹çœ‹è¿™æ¬¡åŸ‹ç‚¹ bug çš„â€œè¯æ®â€ï¼š **2016**0629104535 -&gt; ï¼ˆ**0028**0629104535ï¼‰ï¼Œé—®é¢˜å¥½åƒä¹Ÿæ˜¯å‡ºåœ¨å¹´ä»½ä¸Šï¼Œé‚£ä¹ˆ 0028 ä»£è¡¨ä»€ä¹ˆå‘¢ï¼Ÿäºæ˜¯æˆ‘å…ˆåæ±‚åŠ©äº†åº¦å¨˜ã€stackoverflowã€bingï¼Œæœ€ç»ˆåœ¨ bing ä¸Šæ‰¾åˆ°äº†è¿™æ ·ä¸€ç¯‡æ–‡ç«  [How TechCrunch Japan broke our app - Handling local calendars in Swift](http://blog.famanson.com/2016/01/07/handling-local-calendars-is-a-pain/)ï¼Œé‡Œé¢ä¸“é—¨æåˆ°äº†ä¸€ä¸ªå…³äºæ—¥æœ¬æ—¥å†ï¼ˆJapan calendarï¼‰å’Œå…¬å†ï¼ˆGregorian calendarï¼‰ä¹‹é—´åŒºåˆ«çš„ä¾‹å­ï¼Œå½“æˆ‘çœ‹åˆ°è¿™æ ·ä¸€æ®µä»¤äººæ„ŸåŠ¨çš„è¯æ—¶:</span><br><span class="line">&gt; It means that any NSDate instances retrieved from CoreData would always point to the right point in time, i.e. 04 Jan 0028 in Japan calendar now always points to the same point in time as 04 Jan 2016 in Gregorian calendar (having the same Unix timestamp 1451865600).   </span><br><span class="line"></span><br><span class="line">åŸæ¥å…¬å†2016å¹´ç›¸å½“äºæ—¥æœ¬å¹³æˆ28å¹´ï¼Œæˆ‘é¡¿æ—¶æ„Ÿè§‰è±ç„¶å¼€æœ—ï¼Œä»¿ä½›ç»ˆäºæ‰¾åˆ°å¿ƒç›®ä¸­çš„ the one äº†ã€‚</span><br><span class="line">æ‰¾åˆ°é—®é¢˜æ‰€åœ¨åï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¯•éªŒéªŒè¯äº†ã€‚</span><br><span class="line">è¿˜æ˜¯é‚£æ®µä»£ç ï¼š</span><br></pre></td></tr></table></figure></p>
<p>NSDateFormatter *dateformatter=[[NSDateFormatter alloc] init];<br>[dateformatter setDateFormat:@â€yyyyMMddHHmmssâ€];<br>NSLog(@â€%@â€, [dateformatter stringFromDate:[NSDate date]]);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ‰“å¼€æ¨¡æ‹Ÿå™¨çš„è®¾ç½®-&gt;é€šç”¨-&gt;è¯­è¨€ä¸åœ°åŒº-&gt;æ—¥å†ï¼Œæˆ‘ä»¬ä¾æ¬¡é€‰æ‹©â€œå…¬å†â€ã€â€œæ—¥æœ¬æ—¥å†â€ã€â€œä½›æ•™æ—¥å†â€ï¼Œå¹¶è¿è¡Œå·¥ç¨‹ï¼Œconsole æ‰“å°å‡ºæ¥çš„ç»“æœæ˜¯å¦‚ä¸‹ã€‚</span><br><span class="line"></span><br><span class="line">è¯•éªŒç»“æœè¯´æ˜ä¹‹å‰çš„ç™¾åˆ†ç™¾æ¨æ–­å±å®ã€‚é‚£ç°åœ¨æˆ‘ä»¬è¯¥æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæ‰“å¼€ NSDateFormatter.h æ–‡ä»¶å’Œå‚è€ƒæ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå±æ€§ ``@property (null_resettable, copy) NSCalendar *calendar;`` ï¼Œç„¶åæˆ‘ä»¬å†æ‰“å¼€ NSCalendar ç±»çš„å‚è€ƒæ–‡æ¡£ï¼Œå¯ä»¥çœ‹åˆ° ``Calendar Identifiers``å¸¸é‡çš„ä¸€äº›å£°æ˜ï¼š</span><br></pre></td></tr></table></figure>
<p>NSString <em> const NSCalendarIdentifierGregorian<br>NSString </em> const NSCalendarIdentifierBuddhist<br>NSString <em> const NSCalendarIdentifierChinese<br>NSString </em> const NSCalendarIdentifierCoptic<br>NSString <em> const NSCalendarIdentifierEthiopicAmeteMihret<br>NSString </em> const NSCalendarIdentifierEthiopicAmeteAlem<br>NSString <em> const NSCalendarIdentifierHebrew<br>NSString </em> const NSCalendarIdentifierISO8601<br>NSString <em> const NSCalendarIdentifierIndian<br>NSString </em> const NSCalendarIdentifierIslamic<br>NSString <em> const NSCalendarIdentifierIslamicCivil<br>NSString </em> const NSCalendarIdentifierJapanese<br>NSString <em> const NSCalendarIdentifierPersian<br>NSString </em> const NSCalendarIdentifierRepublicOfChina<br>NSString <em> const NSCalendarIdentifierIslamicTabular<br>NSString </em> const NSCalendarIdentifierIslamicUmmAlQura<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ˜¾è€Œæ˜“è§çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬åº”è¯¥é€‰æ‹© NSCalendarIdentifierGregorianï¼ˆå…¬å†ï¼‰ã€‚</span><br></pre></td></tr></table></figure></p>
<p>NSDateFormatter *dateformatter=[[NSDateFormatter alloc] init];<br>[dateformatter setDateFormat:@â€yyyyMMddHHmmssâ€];<br>[dateformatter setCalendar:[NSCalendar calendarWithIdentifier:NSCalendarIdentifierGregorian]];<br>NSLog(@â€%@â€, [dateformatter stringFromDate:[NSDate date]]);<br>```<br>é‡æ–°ä¿®æ”¹ä»£ç ï¼Œå†æ¬¡éªŒè¯åç»“æœå¦‚ä¸‹ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/814356-d2f00587fcebd7b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å…¬å†ï¼ˆGregorianï¼‰.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/814356-931849e9dcbb0812.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ—¥æœ¬æ—¥å†ï¼ˆJapaneseï¼‰.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/814356-5366a957d3f41bbe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä½›æ•™æ—¥å†ï¼ˆBuddhistï¼‰.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/814356-e355753fb08c4583.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è®¾ç½®é€‰é¡¹ä¸­ä¸ºæ—¥æœ¬æ—¥å†ï¼ˆJapaneseï¼‰ï¼Œä½†ä»£ç ä¸­è®¾äº† calendar å±æ€§.png"></p>
<p>è¯•éªŒç»“æœè¯æ˜è®¾ç½® NSDateFormatter å¯¹è±¡çš„ calendar å±æ€§ä¸º identifier ä¸ºå…¬å†<code>NSCalendarIdentifierGregorian</code>çš„ NSCalendar å¯¹è±¡å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚</p>
<p>NSDateFormatter æ˜¯æˆ‘ä»¬ç»å¸¸éœ€è¦ä½¿ç”¨çš„ä¸€ä¸ªç±»ï¼Œä½†åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„å¾ˆå¤šæœ‰å…³åœ°åŒºï¼Œæ—¶é—´ï¼Œæ€§èƒ½æ–¹é¢çš„é—®é¢˜ï¼Œè¦æƒ³çŸ¥é“å¦‚ä½•ä¸€ä¸€é¿å…é‚£äº›å‘ï¼Œå¤šè¯»å®˜æ–¹æ–‡æ¡£æ˜¯ä¸€ä¸ªä¸Šä½³çš„é€‰æ‹©ã€‚</p>
<p>One more thingï¼Œäººè ¢å°±è¦å¤šè¯»ä¹¦å•¦ï¼ä¸ç„¶è¿æ—¥æœ¬æ—¥å†æ˜¯ä»€ä¹ˆéƒ½ä¸çŸ¥é“æ˜¯ä»€ä¹ˆã€‚Just kidding! ğŸ˜„</p>
<blockquote>
<p>å‚è€ƒèµ„æ–™:<br>ï¼ˆ1ï¼‰How TechCrunch Japan broke our app - Handling local calendars in Swiftï¼š<a href="http://blog.famanson.com/2016/01/07/handling-local-calendars-is-a-pain/" target="_blank" rel="noopener">http://blog.famanson.com/2016/01/07/handling-local-calendars-is-a-pain/</a><br>ï¼ˆ2ï¼‰å®˜æ–¹æ–‡æ¡£: Data Formatting Guide</p>
</blockquote>
<hr>
<blockquote>
<p>æ‹“å±•å»¶ä¼¸ï¼š</p>
</blockquote>
<p>ï¼ˆ1ï¼‰æ—¥å†æœ‰å“ªå‡ ç§ï¼Ÿä»€ä¹ˆæ˜¯æ—¥æœ¬æ—¥å†ï¼Ÿä»€ä¹ˆæ˜¯ä½›æ•™æ—¥å†ï¼Ÿ<br>ï¼ˆ2ï¼‰å¦‚ä½•æ­£ç¡®ä½¿ç”¨ NSDateFormatter ï¼Ÿ</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/01/03/2016-review/" class="prev">PREV</a><a href="/2016/05/08/github-search-tips/" class="next">NEXT</a></div><div class="copyright"><p>Â© 2015 - 2018 <a href="http://yoursite.com">ShannonChenCHN</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>