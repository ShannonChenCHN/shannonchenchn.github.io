<!DOCTYPE html><html lang=""><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> [React Native] React ä¸­çš„çŠ¶æ€ï¼ˆStateï¼‰ Â· Shannon's Blog</title><meta name="description" content="[React Native] React ä¸­çš„çŠ¶æ€ï¼ˆStateï¼‰ - ShannonChenCHN"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Shannon's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">TAG</a></li><li class="nav-list-item"><a href="https://github.com/ShannonChenCHN" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">[React Native] React ä¸­çš„çŠ¶æ€ï¼ˆStateï¼‰</h1><div class="post-info">Jul 8, 2017</div><div class="post-content"><h3 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h3><ul>
<li>1.<code>state</code> å±æ€§<ul>
<li>1.1 <code>state</code>å±æ€§çš„ä»‹ç»</li>
<li>1.2 <code>state</code> çš„ä½¿ç”¨</li>
</ul>
</li>
<li>2.<code>setState()</code> æ–¹æ³•<ul>
<li>2.1 ç¬¬ä¸€ä¸ªå‚æ•°ï¼š<code>updater</code> å‡½æ•°</li>
<li>2.2 ç¬¬äºŒä¸ªå‚æ•°ï¼š<code>callback</code> </li>
</ul>
</li>
<li>3.æ­£ç¡®æ“ä½œ state<ul>
<li>3.1 ä¸è¦ä½¿ç”¨ <code>this.state</code> æ¥ç›´æ¥ä¿®æ”¹ <code>state</code></li>
<li>3.2 çŠ¶æ€æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„</li>
<li>3.3 çŠ¶æ€æ›´æ–°æ˜¯ä¸€ä¸ªåˆå¹¶çš„è¿‡ç¨‹</li>
</ul>
</li>
<li>4.å•å‘æ•°æ®æµ</li>
<li>5.å®Œæ•´ç¤ºä¾‹ä»£ç </li>
</ul>
<p><code>state</code> å±æ€§æ˜¯ React ç»„ä»¶ç”¨æ¥æ›´æ–°æ•°æ®çš„æ ¸å¿ƒç‰¹æ€§ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å¹³æ—¶è§å¾—æœ€å¤šçš„å±æ€§ä¹‹ä¸€ï¼Œé‚£ä¹ˆä½ å¯¹ <code>state</code> åˆäº†è§£å¤šå°‘å‘¢ï¼Ÿ</p>
<h3 id="1-state-å±æ€§"><a href="#1-state-å±æ€§" class="headerlink" title="1. state å±æ€§"></a>1. <code>state</code> å±æ€§</h3><h4 id="1-1-stateå±æ€§çš„ä»‹ç»"><a href="#1-1-stateå±æ€§çš„ä»‹ç»" class="headerlink" title="1.1 stateå±æ€§çš„ä»‹ç»"></a>1.1 <code>state</code>å±æ€§çš„ä»‹ç»</h4><p>æˆ‘ä»¬ä½¿ç”¨ä¸¤ç§æ•°æ®æ¥æ§åˆ¶ä¸€ä¸ªç»„ä»¶ï¼š<code>props</code> å’Œ <code>state</code>ã€‚<code>props</code> æ˜¯åœ¨çˆ¶ç»„ä»¶ä¸­æŒ‡å®šï¼Œè€Œä¸”ä¸€ç»æŒ‡å®šï¼Œåœ¨è¢«æŒ‡å®šçš„ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸­åˆ™ä¸å†æ”¹å˜ã€‚ å¯¹äºéœ€è¦æ”¹å˜çš„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>state</code>ã€‚</p>
<p><code>state</code> å±æ€§ä¸»è¦ç”¨æ¥å­˜å‚¨ç»„ä»¶è‡ªèº«éœ€è¦çš„æ•°æ®ï¼Œæ˜¯ç»„ä»¶è‡ªå·±ç§æœ‰çš„ï¼Œæˆ‘ä»¬ä¸€èˆ¬é€šè¿‡ä¿®æ”¹ <code>state</code> å±æ€§çš„å€¼æ¥æ›´æ–°æ•°æ®ï¼ŒReact å†…éƒ¨ä¼šç›‘å¬ <code>state</code> çš„å˜åŒ–ï¼Œä¸€æ—¦å‘ç”Ÿå˜åŒ–å°±ä¼šä¸»åŠ¨è§¦å‘ç»„ä»¶çš„ <code>render()</code> æ–¹æ³•æ¥æ›´æ–° Dom ç»“æ„ã€‚</p>
<p><code>state</code> åº”è¯¥æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ã€‚</p>
<h4 id="1-2-state-çš„ä½¿ç”¨"><a href="#1-2-state-çš„ä½¿ç”¨" class="headerlink" title="1.2 state çš„ä½¿ç”¨"></a>1.2 <code>state</code> çš„ä½¿ç”¨</h4><p>ä¸€èˆ¬æ¥è¯´ï¼Œä½ éœ€è¦åœ¨ <code>constructor()</code> æ–¹æ³•ä¸­åˆå§‹åŒ– <code>state</code>ï¼ˆè¿™æ˜¯ES6çš„å†™æ³•ï¼ŒES5 ä¸­ä¸€èˆ¬åœ¨ <code>getInitialState()</code> æ–¹æ³•ä¸­æ¥åˆå§‹åŒ– <code>state</code>ï¼‰ï¼Œç„¶ååœ¨éœ€è¦ä¿®æ”¹æ—¶è°ƒç”¨ <code>setState()</code> æ–¹æ³•ã€‚</p>
<p>ä¸è¦ä½¿ç”¨ <code>this.state</code> æ¥ä¿®æ”¹ <code>state</code> å±æ€§å€¼ï¼Œåº”è¯¥è°ƒç”¨ <code>setState()</code> æ–¹æ³•ï¼Œ<code>this.state</code> æ˜¯ä¸å¯å˜çš„ã€‚</p>
<h3 id="2-setState-æ–¹æ³•"><a href="#2-setState-æ–¹æ³•" class="headerlink" title="2. setState() æ–¹æ³•"></a>2. <code>setState()</code> æ–¹æ³•</h3><p><code>setState()</code> çš„å®Œæ•´è¡¨è¾¾å¼<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setState(updater, [callback])</span><br></pre></td></tr></table></figure></p>
<p><code>setState()</code> æ–¹æ³•ä¼šæŠŠå¯¹ç»„ä»¶ state çš„æ”¹å˜åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ï¼Œå¹¶ä¸”å‘Šè¯‰ React è¿™ä¸ªç»„ä»¶åŠå…¶å­ç»„ä»¶éœ€è¦é‡æ–°æ¸²æŸ“ã€‚</p>
<h4 id="2-1-ç¬¬ä¸€ä¸ªå‚æ•°ï¼šupdater-å‡½æ•°"><a href="#2-1-ç¬¬ä¸€ä¸ªå‚æ•°ï¼šupdater-å‡½æ•°" class="headerlink" title="2.1 ç¬¬ä¸€ä¸ªå‚æ•°ï¼šupdater å‡½æ•°"></a>2.1 ç¬¬ä¸€ä¸ªå‚æ•°ï¼š<code>updater</code> å‡½æ•°</h4><p><code>setState(updater, callback)</code> æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå›ºå®šæ ¼å¼çš„ <code>updater</code> å‡½æ•°ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(prevState, props) =&gt; stateChange</span><br></pre></td></tr></table></figure></p>
<p><code>prevState</code> æ˜¯ä¸€ä¸ªå¯¹ä¹‹å‰çŠ¶æ€ï¼ˆprevious stateï¼‰çš„å¼•ç”¨ï¼Œæˆ‘ä»¬æ˜¯ä¸èƒ½ç›´æ¥ä¿®æ”¹è¿™ä¸ªå‚æ•°çš„å€¼ï¼Œè¦æƒ³ä¿®æ”¹ <code>state</code> çš„å€¼ï¼Œæˆ‘ä»¬åº”è¯¥æ ¹æ® <code>prevState</code> å’Œ <code>props</code> å‚æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ JavaScript å¯¹è±¡ã€‚<br>ä¾‹å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">this.setState((prevState, props) =&gt; &#123;</span><br><span class="line">  return &#123;counter: prevState.counter + props.step&#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>ä½ ä¹Ÿå¯ä»¥ä¼ ä¸€ä¸ªå¯¹è±¡è€Œä¸æ˜¯å‡½æ•°ï¼Œæ¥ä½œä¸º<code>setState(updater, callback)</code> æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ŒReact ä¼šå°†è¯¥å‚æ•° merge åˆ° state ä¸­ã€‚<br>ä¾‹å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.setState(&#123;quantity: 2&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="2-2-ç¬¬äºŒä¸ªå‚æ•°ï¼šcallback"><a href="#2-2-ç¬¬äºŒä¸ªå‚æ•°ï¼šcallback" class="headerlink" title="2.2 ç¬¬äºŒä¸ªå‚æ•°ï¼šcallback"></a>2.2 ç¬¬äºŒä¸ªå‚æ•°ï¼š<code>callback</code></h4><p><code>setState(updater, callback)</code> æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•° <code>callback</code> æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ã€‚</p>
<p>ä¸ºäº†æ›´å¥½çš„æ€§èƒ½è¡¨ç°ï¼ŒReact å¹¶ä¸èƒ½ä¿è¯ <code>setState()</code> ä¸€è¢«è°ƒç”¨ state å°±èƒ½æ›´æ–°ã€‚æ‰€ä»¥ï¼Œå¦‚æœåœ¨è°ƒç”¨ <code>setState()</code> ä¹‹åï¼Œé©¬ä¸Šå°±è¯»å– <code>this.state</code> çš„å€¼çš„è¯ï¼Œå¯èƒ½ä¼šå‡ºç°è¯¯å·®ã€‚<br>å› æ­¤ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæ¨èä½¿ç”¨ <code>componentDidUpdate</code> æˆ–è€… <code>setState(updater, callback)</code> æ–¹æ³•çš„ <code>callback</code> æ¥è·å–æœ€æ–°çš„çŠ¶æ€ã€‚React å®˜æ–¹æ›´æ¨èä½¿ç”¨ <code>componentDidUpdate()</code>ï¼Œè€Œä¸æ˜¯ <code>callback</code> æ¥ç›‘å¬ update äº‹ä»¶ï¼ˆæ³¨ï¼š é™¤é <code>shouldComponentUpdate()</code> æ–¹æ³•è¿”å› <code>false</code>ï¼Œ<code>setState()</code> å°†æ°¸è¿œéƒ½ä¼šå¼•å‘é‡æ–°æ¸²æŸ“ï¼‰ã€‚</p>
<h3 id="3-æ­£ç¡®æ“ä½œ-state"><a href="#3-æ­£ç¡®æ“ä½œ-state" class="headerlink" title="3. æ­£ç¡®æ“ä½œ state"></a>3. æ­£ç¡®æ“ä½œ state</h3><h4 id="3-1-ä¸è¦ä½¿ç”¨-this-state-æ¥ç›´æ¥ä¿®æ”¹-state"><a href="#3-1-ä¸è¦ä½¿ç”¨-this-state-æ¥ç›´æ¥ä¿®æ”¹-state" class="headerlink" title="3.1 ä¸è¦ä½¿ç”¨ this.state æ¥ç›´æ¥ä¿®æ”¹ state"></a>3.1 ä¸è¦ä½¿ç”¨ <code>this.state</code> æ¥ç›´æ¥ä¿®æ”¹ <code>state</code></h4><blockquote>
<p>è®°ä½ï¼Œ<code>this.state</code> æ˜¯ä¸å¯å˜çš„ã€‚</p>
</blockquote>
<p>ä¸è¦ä½¿ç”¨ <code>this.state</code> æ¥ä¿®æ”¹ <code>state</code> å±æ€§å€¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// Wrong</span><br><span class="line">this.state.comment = &apos;Hello&apos;;</span><br></pre></td></tr></table></figure>
<p>åº”è¯¥è°ƒç”¨ <code>setState()</code> æ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// Correct</span><br><span class="line">this.setState(&#123;comment: &apos;Hello&apos;&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="3-2-çŠ¶æ€æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„"><a href="#3-2-çŠ¶æ€æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„" class="headerlink" title="3.2 çŠ¶æ€æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„"></a>3.2 çŠ¶æ€æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„</h4><p>è€ƒè™‘åˆ°æ€§èƒ½é—®é¢˜ï¼Œå¦‚æœåœ¨åŒä¸€ä¸ªå‘¨æœŸå†…ï¼Œè°ƒç”¨äº†å¤šæ¬¡ï¼ŒReact å¯èƒ½ä¼šå°†å¤šä¸ª <code>setState()</code> æ–¹æ³•çš„è°ƒç”¨æ‰¹é‡åˆæˆä¸€æ¬¡æ›´æ–°ã€‚æ¯”å¦‚ï¼Œä½ åœ¨ä¸€ä¸ªå‘¨æœŸå†…ï¼Œå¯¹ä¸€ä¸ªæ•°å€¼è¿›è¡Œå¤šæ¬¡ç´¯åŠ ï¼Œå°±ä¼šå‡ºç°ç±»ä¼¼äºä¸‹é¢çš„è¿™ç§æƒ…å†µï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Object.assign(</span><br><span class="line">  previousState,</span><br><span class="line">  &#123;quantity: state.quantity + 1&#125;,</span><br><span class="line">  &#123;quantity: state.quantity + 1&#125;,</span><br><span class="line">  ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œåé¢çš„è°ƒç”¨ä¼šè¦†ç›–æ‰ä¸Šä¸€æ¬¡è°ƒç”¨åçš„ä¿®æ”¹çš„ state å€¼ï¼Œå› æ­¤ quantity åªç´¯åŠ äº† 1 æ¬¡ã€‚</p>
<p>è€ƒè™‘åˆ° <code>this.props</code> å’Œ<code>this.state</code> å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Œæ‰€ä»¥ï¼Œæ¯æ¬¡è°ƒç”¨ <code>setState()</code> æ–¹æ³•æ—¶ï¼Œæœ€å¥½ä¸è¦ä¾èµ–äº <code>this.props</code> å’Œ<code>this.state</code> æ¥è®¡ç®—æœ€æ–°çš„ <code>state</code>ã€‚</p>
<p>æ€»ä¹‹ï¼Œå¦‚æœåé¢çš„çŠ¶æ€ä¾èµ–äºä¹‹å‰çš„çŠ¶æ€ï¼Œå»ºè®®ä½¿ç”¨ <code>updater</code> å‡½æ•°ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// Correct</span><br><span class="line">this.setState((prevState, props) =&gt; &#123;</span><br><span class="line">  return &#123;quantity: prevState.quantity + 1&#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢ç”¨çš„æ˜¯ <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" rel="noopener">ç®­å¤´å‡½æ•°</a> çš„å½¢å¼ï¼Œå…¶å®ç”¨æ™®é€šçš„å‡½æ•°ä¹Ÿæ˜¯ä¸€æ ·çš„æ•ˆæœï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// Correct</span><br><span class="line">this.setState(function(prevState, props) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    quantity: prevState.quantity + 1;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="3-3-çŠ¶æ€æ›´æ–°æ˜¯ä¸€ä¸ªåˆå¹¶çš„è¿‡ç¨‹"><a href="#3-3-çŠ¶æ€æ›´æ–°æ˜¯ä¸€ä¸ªåˆå¹¶çš„è¿‡ç¨‹" class="headerlink" title="3.3 çŠ¶æ€æ›´æ–°æ˜¯ä¸€ä¸ªåˆå¹¶çš„è¿‡ç¨‹"></a>3.3 çŠ¶æ€æ›´æ–°æ˜¯ä¸€ä¸ªåˆå¹¶çš„è¿‡ç¨‹</h4><p>å½“ä½ è°ƒç”¨ <code>setState()</code> æ–¹æ³•æ—¶ï¼ŒReact ä¼šå°†å°†ä½ å½“å‰æ‰€æä¾›çš„å¯¹è±¡åˆå¹¶åˆ°å½“å‰çš„çŠ¶æ€ä¸­ã€‚<br>ä¾‹å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      posts: [],</span><br><span class="line">      comments: []</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">componentDidMount() &#123;</span><br><span class="line"></span><br><span class="line">    fetchComments().then(response =&gt; &#123;</span><br><span class="line">      this.setState(&#123;</span><br><span class="line">        comments: response.comments</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>åœ¨ä¸Šé¢ğŸ‘†çš„ä¾‹å­ä¸­ï¼Œ state çš„æ›´æ–°åªæ˜¯æ›¿æ¢äº† <code>comments</code>ï¼Œ<code>posts</code>æ˜¯ä¸ä¼šå—åˆ°ä»»ä½•å½±å“çš„ã€‚</p>
<h3 id="4-å•å‘æ•°æ®æµ"><a href="#4-å•å‘æ•°æ®æµ" class="headerlink" title="4.å•å‘æ•°æ®æµ"></a>4.å•å‘æ•°æ®æµ</h3><p>çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶ä¹‹é—´ä¸èƒ½é€šè¿‡ state æ¥äº¤äº’ï¼Œçˆ¶ç»„ä»¶åªèƒ½å°†è‡ªå·±çš„ state å€¼ä¼ ç»™å­ç»„ä»¶çš„ propsã€‚è¿™ç§æ•°æ®ä¼ é€’çš„æ–¹å¼é€šå¸¸è¢«ç§°ä¸º â€œè‡ªé¡¶å‘ä¸‹ï¼ˆtop-downï¼‰â€æˆ–è€…â€œå•å‘ï¼ˆunidirectionalï¼‰â€æ•°æ®æµã€‚</p>
<p>ä»»ä½• state éƒ½æ˜¯ç”±ä¸€ä¸ªç‰¹å®šçš„ç»„ä»¶æ‰€æ‹¥æœ‰çš„ï¼Œä»»ä½•ç”± state é©±åŠ¨çš„æ•°æ®æˆ–è€… UI åªä¼šå½±å“åˆ°è¯¥ç»„ä»¶çš„å­ç»„ä»¶ã€‚</p>
<p>å¦‚æœä½ å°†ç»„ä»¶æ ‘æƒ³è±¡æˆä¸€ä¸ª props ç€‘å¸ƒï¼Œé‚£ä¹ˆæ¯ä¸ªç»„ä»¶çš„çŠ¶æ€å°±åƒæ˜¯é‚£ä¸ªç»„ä»¶æ°´æºä¸Šçš„é™„å±å“ï¼Œä½†æ˜¯ä¹Ÿæ˜¯å‘ä¸‹æµåŠ¨çš„ã€‚</p>
<h3 id="5-å®Œæ•´ç¤ºä¾‹ä»£ç "><a href="#5-å®Œæ•´ç¤ºä¾‹ä»£ç " class="headerlink" title="5. å®Œæ•´ç¤ºä¾‹ä»£ç "></a>5. å®Œæ•´ç¤ºä¾‹ä»£ç </h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&apos;use strict&apos;;</span><br><span class="line"></span><br><span class="line">import React, &#123; Component, &#125; from &apos;react&apos;;</span><br><span class="line">import &#123;</span><br><span class="line">  AppRegistry,</span><br><span class="line">  StyleSheet,</span><br><span class="line">  View,</span><br><span class="line">  Text,</span><br><span class="line">  TouchableOpacity,</span><br><span class="line">&#125; from &apos;react-native&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">export default class StateDemo extends Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return &lt;Container style=&#123;styles.container&#125; /&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Container extends Component &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    super();</span><br><span class="line">    // è®¾ç½®åˆå§‹çŠ¶æ€</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      showText: true,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">      // æ ¹æ®çŠ¶æ€å†³å®šå±•ç¤ºä»€ä¹ˆæ–‡å­—</span><br><span class="line">      var text = (this.state.showText == true) ? &apos;Hello&apos; : &quot;&quot;;</span><br><span class="line">      var buttonTitle = (this.state.showText == true) ? &apos;Hide&apos; : &quot;Show&quot;;</span><br><span class="line"></span><br><span class="line">      return (</span><br><span class="line">        &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">          &lt;Text style=&#123;styles.text&#125;&gt;&#123;text&#125;&lt;/Text&gt;</span><br><span class="line">          &lt;TouchableOpacity</span><br><span class="line">            onPress = &#123;() =&gt; &#123;</span><br><span class="line">             // æ›´æ–°çŠ¶æ€</span><br><span class="line">              this.setState(</span><br><span class="line">                previousState =&gt; &#123;</span><br><span class="line">                  return &#123; showText: !previousState.showText &#125;;</span><br><span class="line">                &#125;</span><br><span class="line">              );</span><br><span class="line"></span><br><span class="line">            &#125;&#125;&gt;</span><br><span class="line">            &lt;Text style=&#123;styles.buttonTitle&#125;&gt;&#123;buttonTitle&#125;&lt;/Text&gt;</span><br><span class="line">          &lt;/TouchableOpacity&gt;</span><br><span class="line">        &lt;/View&gt;</span><br><span class="line">  );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> const styles = StyleSheet.create(&#123;</span><br><span class="line">   container: &#123;</span><br><span class="line">     flex: 1,</span><br><span class="line">     backgroundColor: &apos;yellow&apos;,</span><br><span class="line">     alignItems: &apos;center&apos;,</span><br><span class="line">   &#125;,</span><br><span class="line"></span><br><span class="line">   text: &#123;</span><br><span class="line">     marginTop: 200,</span><br><span class="line">     fontSize: 30,</span><br><span class="line">     textAlign: &apos;center&apos;,</span><br><span class="line">   &#125;,</span><br><span class="line"></span><br><span class="line">   buttonTitle: &#123;</span><br><span class="line">     width: 70,</span><br><span class="line">     marginTop: 10,</span><br><span class="line">     fontSize: 20,</span><br><span class="line">     textAlign: &apos;center&apos;,</span><br><span class="line">     backgroundColor: &apos;green&apos;,</span><br><span class="line">   &#125;,</span><br><span class="line"></span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="å»¶ä¼¸é˜…è¯»"><a href="#å»¶ä¼¸é˜…è¯»" class="headerlink" title="å»¶ä¼¸é˜…è¯»"></a>å»¶ä¼¸é˜…è¯»</h3><ul>
<li><a href="https://facebook.github.io/react/docs/react-component.html" target="_blank" rel="noopener">React API Reference: React.Component</a></li>
<li><a href="https://facebook.github.io/react/docs/state-and-lifecycle.html" target="_blank" rel="noopener">React API Reference: State and Lifecycle</a></li>
<li><a href="http://reactnative.cn/docs/0.45/state.html#content" target="_blank" rel="noopener">React Native å®˜æ–¹æ–‡æ¡£ï¼šState</a></li>
<li>ã€ŠReact Native å…¥é—¨ä¸å®æˆ˜ã€‹</li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2017/07/08/react-components-props/" class="prev">PREV</a><a href="/2017/07/08/2017-half-review/" class="next">NEXT</a></div><div class="copyright"><p>Â© 2015 - 2019 <a href="http://yoursite.com">ShannonChenCHN</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>